extend to k way partitions include the weights too
read/write from/to file
